### Preguntas:

#### 1. ¿Cuántos clientes tienen apellidos que acaban con “ez”?

```sql
  -- clientes donde el apellido termina en 'ez'
    -- by sanchezluys 2024, v1
    SELECT 
            * 
    FROM 
            credicel_alura_bd.tabla_de_clientes
    WHERE
            NOMBRE LIKE '%ez';
```
![Reto 1](/imagenes/reto_1.png)

#### 2. ¿Cuáles son los barrios en Ciudad de México que tienen clientes?

```sql
 -- reto: ¿Cuáles son los barrios en Ciudad de México que tienen clientes?
    -- by sanchezluys, 2024, v1
    SELECT  DISTINCT
            BARRIO,
            CIUDAD
    FROM credicel_alura_bd.tabla_de_clientes
    WHERE
        CIUDAD='Ciudad de Mexico';
```

![Reto 2](/imagenes/reto_2.png)

#### 3. Queremos obtener las 10 primeras ventas del día 01/01/2017. ¿Cuál sería el comando SQL para obtener este resultado?

```sql
        -- 10 primeras ventas del dia 01-01-2017
        -- by sanchezluys, 2024, v1
        SELECT 
                * 
        FROM credicel_alura_bd.facturas
        WHERE FECHA_VENTA ='2017-01-01'
        LIMIT 10;
```

![Reto 3](/imagenes/reto_3.png)

#### 4. ¿Cuál (o cuáles) fue (fueron) la(s) mayor(es) venta(s) del producto “Refrescante, 1 Litro, Frutilla/Limón”, en cantidad? (Obtenga este resultado utilizando 2 comandos SQL).

Paso 1: Obtener el id del producto especificado. id=1101035

```sql
        -- buscando producto “Refrescante, 1 Litro, Frutilla/Limón”, en cantidad?
        -- para obtener el codigo del producto: id= 1101035
        SELECT 
                * 
        FROM credicel_alura_bd.tabla_de_productos
        WHERE 	NOMBRE_DEL_PRODUCTO='Refrescante' and 
                        TAMANO='1 Litro' 
                and SABOR='Frutilla/Limon';
```

![Reto 4.1](/imagenes/reto_4_1.png)

Paso 2: con el id se verrifica en la tabla de items_facturas

```sql
        -- ventas del producto id=1101035, ORDENADOS, SIN REPETIR
        -- POR CANTIDAD
        SELECT  DISTINCT
                        CODIGO_DEL_PRODUCTO,
                CANTIDAD
        FROM  	credicel_alura_bd.items_facturas
        WHERE	CODIGO_DEL_PRODUCTO=1101035
        ORDER BY CANTIDAD DESC;
```

![Reto 4.2](/imagenes/reto_4_2.png)


#### 5. Aprovechando el ejercicio del video anterior ¿Cuántos ítems vendidos cuentan con la mayor cantidad del producto '1101035'?

```sql
        -- Aprovechando el ejercicio del video anterior 
        -- ¿Cuántos ítems vendidos cuentan con la mayor cantidad del producto '1101035'?
        SELECT 
                NUMERO AS ITEM,
                CODIGO_DEL_PRODUCTO,
                CANTIDAD,
                COUNT(CANTIDAD)
        FROM credicel_alura_bd.items_facturas
        WHERE CODIGO_DEL_PRODUCTO='1101035' AND CANTIDAD=99
        GROUP BY CANTIDAD
        ORDER BY CANTIDAD DESC;
```

![Reto 5](/imagenes/reto_5.png)


#### 6. ¿Quiénes fueron los clientes que realizaron más de 2000 compras en 2016?

```sql
        -- BY SANCHEZLUYS, 2024, V1
        -- ¿Quiénes fueron los clientes que realizaron más de 2000 compras en 2016?
        SELECT 
                        DNI,
                FECHA_VENTA,
                COUNT(NUMERO) AS COMPRAS,
                IMPUESTO
        FROM 
                        credicel_alura_bd.facturas
        WHERE
                        YEAR(FECHA_VENTA)=2016
        GROUP BY DNI
        HAVING COMPRAS > 2000;
```

![Reto 6](/imagenes/reto_6.png)


#### 7. Registre el año de nacimiento de los clientes y clasifíquelos de la siguiente manera:
- Nacidos antes de 1990= Viejos, 
- nacidos entre 1990 y 1995= Jóvenes y
- nacidos después de 1995= Niños. 
- Liste el nombre del cliente y esta clasificación.

```sql
        -- reto 7. Registre el año de nacimiento de los clientes y clasifíquelos de la siguiente manera:
        -- Nacidos antes de 1990= Viejos, 
        -- nacidos entre 1990 y 1995= Jóvenes y
        -- nacidos después de 1995= Niños. 
        -- Liste el nombre del cliente y esta clasificación.
        SELECT
                        NOMBRE,
                FECHA_DE_NACIMIENTO,
                EDAD,
                CASE
                                WHEN YEAR(FECHA_DE_NACIMIENTO) <= 1990 THEN 'VIEJOS'
                WHEN YEAR(FECHA_DE_NACIMIENTO) > 1990 AND YEAR(FECHA_DE_NACIMIENTO)< 1995 THEN 'JOVENES'
                ELSE 'NIÑOS'
                END AS CLASIFICA_COMO
        FROM
                        tabla_de_clientes;
```

![Reto 7](/imagenes/reto_7.png)


#### 8. Obtén la facturación anual de la empresa. Ten en cuenta que el valor financiero de las ventas consiste en multiplicar la cantidad por el precio.

```sql
        -- Obtén la facturación anual de la empresa. 
        -- Ten en cuenta que el valor financiero de las ventas consiste en multiplicar la cantidad por el precio.
        SELECT 	YEAR(FECHA_VENTA) AS AÑO,
                SUM(CANTIDAD*PRECIO) AS TOTAL_FACTURAS
        FROM   	facturas
        join	items_facturas
                        on facturas.NUMERO=items_facturas.NUMERO
        GROUP BY YEAR(FECHA_VENTA);
```

![Reto 8](/imagenes/reto_8.png)

#### 9. Cuál sería la consulta utilizando la subconsulta que sería equivalente a:

```sql
        SELECT  DNI, 
                COUNT(*) 
        FROM facturas
        WHERE YEAR(FECHA_VENTA) = 2016
        GROUP BY DNI
        HAVING COUNT(*) > 2000;
```
![Reto 8-1](/imagenes/reto_8_1.png)

```sql
        SELECT 	T.DNI,
                T.CUENTA
        FROM	(
                SELECT 	DISTINCT 
                        DNI,
                        COUNT(*) AS CUENTA
                FROM facturas
                WHERE YEAR(FECHA_VENTA)=2016
                GROUP BY DNI
                ) AS T
        WHERE  T.CUENTA > 2000;
```

![Reto 8-2](/imagenes/reto_8_2.png)


