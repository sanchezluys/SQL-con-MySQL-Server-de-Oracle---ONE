### Usando DISTINCT

- Devuelve registros no repetidos o distintos
- 


Ejemplo:

```sql
    SELECT DISTINCT
	ENVASE,
    TAMANO
FROM 
	credicel_alura_bd.tabla_de_productos;
```

![Ejemplo Distinct](/imagenes/ejemplo_distinct.png)

### Usando el LIMIT

- Limita en numero de registros que se entregan del query
- se puede fijar el indice LIMIT 3,2 que a partir del tercer indice tomar solo 2,
- el primer registro es 0

```sql
SELECT
	ENVASE,
    TAMANO
FROM 
	credicel_alura_bd.tabla_de_productos
LIMIT 3;
```

```sql
    -- devuelve 2 registros despues del registro numero 3
    SELECT * 
    FROM credicel_alura_bd.tabla_de_productos 
    limit 3,2;
```

### Ordenando con ORDER BY ASC/DESC

- por defecto ordena ascendente
- se puede ordenar con varias columnas ORDER BY tabla1, tabla 2ASC

```sql
    -- uso del order by
    SELECT 
        *
    FROM
        credicel_alura_bd.tabla_de_productos
    ORDER BY NOMBRE_DEL_PRODUCTO DESC, TAMANO ASC;
```

### Filtrando con GROUP BY

- se deben usar funciones de agrupamiento
- SUM(), AVG(), MIN(), MAX(), COUNT(), al usarla se le debe dar un alias a la columna
- estas funciones tambien se puede usar sin el group by

Ejemplos:

```sql
    SELECT 
        ESTADO,
        SUM(LIMITE_DE_CREDITO) AS LIMITE_TOTAL
    FROM
        credicel_alura_bd.tabla_de_clientes
    GROUP BY ESTADO;
```

```sql
    SELECT 
        ENVASE,
        MAX(PRECIO_DE_LISTA) AS Mayor_Precio 
    FROM
        credicel_alura_bd.tabla_de_productos
    GROUP BY ENVASE;
```

```sql
    SELECT 
        ENVASE,
        COUNT(*) 
    FROM
        credicel_alura_bd.tabla_de_productos
    GROUP BY ENVASE;
```

```sql
    SELECT 
        BARRIO,
        SUM(LIMITE_DE_CREDITO) AS LIMITE
    FROM
        credicel_alura_bd.tabla_de_clientes
    GROUP BY BARRIO;
```

con dobles agrupaciones:

```sql
    SELECT 
        ESTADO,
        BARRIO,
        MAX(LIMITE_DE_CREDITO) AS LIMITE
    FROM
        credicel_alura_bd.tabla_de_clientes
    GROUP BY ESTADO, BARRIO;
```

### Filtrando con HAVING

- Se aplica sobre el resultado de una agregacion
- va despues de group by

Ejemplos:

```sql
    SELECT 	ESTADO,
            SUM(LIMITE_DE_CREDITO) AS LIMITE_TOTAL
    FROM
            tabla_de_clientes
    GROUP BY
            ESTADO
    HAVING  LIMITE_TOTAL > 300000
    -- Respuesta: EM  1495000
```

```sql
    SELECT	ENVASE,
            MAX(PRECIO_DE_LISTA) AS PRECIO_MAXIMO,
            MIN(PRECIO_DE_LISTA) AS PRECIO_MINIMO
    FROM
            tabla_de_productos
    GROUP BY
            ENVASE
    HAVING SUM(PRECIO_DE_LISTA) > 80
```

```sql
    SELECT	ENVASE,
            MAX(PRECIO_DE_LISTA) AS PRECIO_MAXIMO,
            MIN(PRECIO_DE_LISTA) AS PRECIO_MINIMO,
            SUM(PRECIO_DE_LISTA) AS SUMA_PRECIO
    FROM
            tabla_de_productos
    GROUP BY
            ENVASE
    HAVING SUM(PRECIO_DE_LISTA) > 80
```

```sql
    SELECT	ENVASE,
            MAX(PRECIO_DE_LISTA) AS PRECIO_MAXIMO,
            MIN(PRECIO_DE_LISTA) AS PRECIO_MINIMO,
            SUM(PRECIO_DE_LISTA) AS SUMA_PRECIO
    FROM
            tabla_de_productos
    GROUP BY
            ENVASE
    HAVING SUM(PRECIO_DE_LISTA) >= 80
            AND MAX(PRECIO_DE_LISTA) >=5
```

### Usando CASE

-Se realiza un test en uno o mas campos y dependiendo del resultado obtendremos un valor especifico.

```sql
    CASE
        WHEN CONDICION_1 THEN VALUE_1
        WHEN CONDICION_2 THEN VALUE_2
        ...
        ELSE VALOR_ELSE
    END
```
Ejemplos:

```sql
    SELECT X
    CASE
        WHEN Y>=8 AND Y<=10 THEN 'MUY BUENO'
        WHEN Y>=7 AND Y<8 THEN 'BUENO'
        WHEN Y>=5 AND Y<7 THEN 'REGULAR'
        ELSE 'MALO'
    END
    FROM TABLA
```

```sql
    SELECT  NIMBRE_DEL_PRODUCTO,
            PRECIO_DE_LISTA,
    CASE
        WHEN PRECIO_DE_LISTA >=12 THEN 'MUY COSTOSO'
        WHEN PRECIO_DE_LISTA >=5 AND PRECIO_DE_LISTA<12 THEN 'ASEQUIBLE'
        ELSE 'BARATO'
    END AS PRECIO
    FROM TABLA_DE_PRODUCTOS
```

```sql
    SELECT  ENVASE,
            SABOR,
        CASE
            WHEN PRECIO_DE_LISTA >=12 THEN 'MUY COSTOSO'
            WHEN PRECIO_DE_LISTA >=5 AND PRECIO_DE_LISTA<12 THEN 'ASEQUIBLE'
            ELSE 'BARATO'
        END AS PRECIO,
        MIN(PRECIO_DE_LISTA) AS PRECIO_MINIMO
        FROM tabla_de_productos
        WHERE TAMANO='700 ml'
        GROUP BY 
            CASE
            WHEN PRECIO_DE_LISTA >=12 THEN 'MUY COSTOSO'
            WHEN PRECIO_DE_LISTA >=5 AND PRECIO_DE_LISTA<12 THEN 'ASEQUIBLE'
            ELSE 'BARATO'
        END 
        ORDER BY ENVASE;
```