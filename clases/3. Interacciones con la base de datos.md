## Interacciones con la base de datos

Creando un procedimiento para agregar un producto:

```sql
    USE `credicel_alura_bd`;
    DROP procedure IF EXISTS `agregar_producto`;

    DELIMITER $$
        USE `credicel_alura_bd`$$
        CREATE PROCEDURE `agregar_producto` ()
        BEGIN
            INSERT INTO	tabla_de_productos
                VALUES(838820,	"Clean",	"1,5 Litros",	"Naranja",	"Botella PET",	12.01);
        END$$

    DELIMITER ;
```

### Parametros


Creando un procedimiento que guarde un nuevo producto usando parametros

```sql
    USE `credicel_alura_bd`;
    DROP procedure IF EXISTS `agregar_producto_paramatreos`;

    DELIMITER $$
        USE `credicel_alura_bd`$$
        CREATE PROCEDURE `agregar_producto_paramatreos` (id varchar(20), 
                                                        nombre VARCHAR(20), 
                                                        tamano varchar(20),
                                                        sabor varchar(20),
                                                        envase varchar(20),
                                                        precio_lista decimal(5,2)
                                                        )
        BEGIN
            INSERT INTO	tabla_de_productos
                        VALUES(id,	nombre,	tamano,	sabor,	envase,	precio_lista);
        END$$

    DELIMITER ;
```

### Control de errores

- Se usa para mejorar el mensaje de error que envia mysql
- se puede usar una variable
- DECLARE EXIT HANDLER FOR NUMERO_ERROR
- Por ejemplo al intentar agregar un registro que tiene un id que ya existe se genera el error 1062, ese numero es el que podemos manejar
- 

```sql

    USE `credicel_alura_bd`;
    DROP procedure IF EXISTS `inlcluir_dato_control_error`;

    USE `credicel_alura_bd`;
    DROP procedure IF EXISTS `credicel_alura_bd`.`inlcluir_dato_control_error`;
    ;

    DELIMITER $$
        USE `credicel_alura_bd`$$
        CREATE DEFINER=`credicel_alura_admin`@`190.28.%` 
        PROCEDURE `inlcluir_dato_control_error`(id varchar(20), 
                                                nombre VARCHAR(20), 
                                                tamano varchar(20),
                                                sabor varchar(20),
                                                envase varchar(20),
                                                precio_lista decimal(5,2))
        BEGIN
            DECLARE mensaje VARCHAR(40);
            DECLARE EXIT HANDLER FOR 1062
                BEGIN
                    SET mensaje="El id del producto ya existe, error!";
                    SELECT mensaje;
                END;
            
            INSERT INTO	tabla_de_productos
                                VALUES(id,	nombre,	tamano,	sabor,	envase,	precio_lista);
            SET mensaje="Producto registrado con exito!!";
            SELECT mensaje;
            
        END$$

    DELIMITER ;
```

Resultado al intentar agregar un producto con id repetido

![Manejo de Error](/imagenes/clase03/manejo_error_1062.png)


### Atribuci√≥n de valor usando SELECT

