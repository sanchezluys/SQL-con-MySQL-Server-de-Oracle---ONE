## DESAFIOS

### 1. Crea un SP con las siguientes 4 variables y que al utilizar el comando CALL, las mismas puedan ser visualizadas.

```sql
    /*
    Nombre: Cliente. 
    Tipo: Caracteres con 10 posiciones. 
    Valor: Juan.

    Nombre: Edad. 
    Tipo: Entero. 
    Valor: 10.

    Nombre: Fecha_Nacimiento. 
    Tipo: Fecha. 
    Valor: 10/01/2007.

    Nombre: Costo. 
    Tipo: Número con casillas decimales. 
    Valor: 10.23 .
    */

```


### 2. Crea un SP que actualice la edad de los clientes. Recuerda que el comando para calcular la edad, en la tabla tabla_de_clientes es:

```sql

    TIMESTAMPDIFF(YEAR, FECHA_DE_NACIMIENTO, CURDATE()) as EDAD
```

![Edades en BD](/imagenes/desafios/edades_bd.png)


Procedimiento para actualizar las edades a hoy 4 agosto 2024

```sql
    USE `credicel_alura_bd`;
    DROP procedure IF EXISTS `calcula_edad`;

    DELIMITER $$
        USE `credicel_alura_bd`$$
        CREATE PROCEDURE `calcula_edad` ()
        BEGIN
            UPDATE credicel_alura_bd.tabla_de_clientes
                SET EDAD=TIMESTAMPDIFF(YEAR, FECHA_DE_NACIMIENTO, CURDATE());
        END$$

    DELIMITER ;
```

Tome en cuenta que el MySQL por defecto no deja usar update y delete sin un where, es necesario desactivar esta proteccion:

![Desactivar Safe Mode](/imagenes/desafios/desactivar_safe_mode.png)

Resultados:

![Resultados Edad](/imagenes/desafios/resultados_edad.png)


### 3. Crea un SP para reajustar el % de comisión de los vendedores. Incluye como parámetro del SP el %, expresado en valor (Ex: 0,90).

- Nombre del Stored Procedure: reajuste_comision.



### 4. ¿Cuál es el comando para tratar los errores?

```SQL
    DECLARE EXIT HANDLER FOR 1062 -- #ERROR
		BEGIN
			SET mensaje="El id del producto ya existe, error!";
            SELECT mensaje;
        END;
```


### 4. Crea una variable llamada N_FACTURAS y atribuye a ella el número de facturas del día 01/01/2017. Muestra en el output del script el valor de la variable. (Nombra este Stored Procedure como cantidad_facturas).




#### 5. ESTE PUNTO: También, debe exhibir el número de facturas NO SE ESTÁ CUMPLIENDO EN EL CÓDIGO... FALTARÍA UN SELECT AL FINAL PARA MOSTRAR EL NRO...

- Crea un Stored Procedure que, basado en una fecha, calcule el número de facturas. 
- Si aparecen más de 70 facturas exhibimos el mensaje: ‘Muchas facturas’. 
- En otro caso, exhibimos el mensaje ‘Pocas facturas’
- También, debe exhibir el número de facturas. Llamaremos este Stored Procedure como: evaluacion_facturas.
- La fecha empleada para evaluar la cantidad de facturas será un parámetro del Stored Procedure.






#### 6. ¡Desafío! Observa la siguiente consulta:

```sql
    SELECT SUM(B.CANTIDAD * B.PRECIO) AS TOTAL_VENTA 
    FROM 
        facturas A 
    INNER   JOIN items_facturas B
            ON A.NUMERO = B.NUMERO
    WHERE A.FECHA_VENTA = '20170301';Copia el código
    -- Esta consulta devuelve el valor de la facturación en una fecha determinada.
```

- Construye un Stored Procedure llamado comparacion_ventas que compare las ventas en dos fechas distintas (Estas fechas serán los parámetros de la SP). 
- Si la variación porcentual de estas ventas es mayor al 10% la respuesta debe ser ‘Verde’. 
- Si está entre -10% y 10% debe retornar ‘Amarillo’. 
- Si la variación es menor al -10% debe retornar ‘Rojo’.